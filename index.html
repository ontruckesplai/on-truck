<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ruta Barcelona → París (Gratis)</title>

  <!-- Leaflet (mapa) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- Leaflet Routing Machine (trazado de ruta) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css"/>
  <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.min.js"></script>

  <style>
    html, body { height: 100%; margin: 0; font-family: Arial, sans-serif; }
    #map { height: calc(100vh - 64px); }
    .title {
      padding: 10px 12px; font-weight: 600; box-shadow: 0 2px 8px rgba(0,0,0,.08);
    }
    /* NUEVO: barra inferior para stats */
    .stats {
      height: 44px; display:flex; align-items:center; justify-content:center;
      background:#fafafa; border-top:1px solid #eee; font-size:14px;
    }
    .stats strong { margin: 0 .25rem; }
  </style>
</head>
<body>
  <div class="title">Ruta: Barcelona → París</div>
  <div id="map"></div>
  <!-- NUEVO: contenedor para distancia/tiempo -->
  <div class="stats" id="stats">Calculando ruta…</div>

  <script>
    // Coordenadas de Barcelona y París (lat, lng)
    const BCN = [41.3874, 2.1686];
    const PAR = [48.8566, 2.3522];


    const centerLat = (BCN[0] + BCN[1]) / 2;
    const centerLon = (PAR[0] + PAR[1]) / 2;
    


    // Crear mapa
    const map = L.map('map').setView([centerLat, centerLon], 6);


    // Capa de teselas (OpenStreetMap)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // Helpers para formatear
    function formatDistance(meters) {
      if (meters < 1000) return `${meters.toFixed(0)} m`;
      return `${(meters/1000).toFixed(1)} km`;
    }
    function formatDuration(seconds) {
      const m = Math.round(seconds / 60);
      const h = Math.floor(m / 60), r = m % 60;
      if (h === 0) return `${m} min`;
      return `${h} h ${r} min`;
    }

    // Control de ruta (usa OSRM público por defecto)
    const routing = L.Routing.control({
      waypoints: [ L.latLng(BCN[0], BCN[1]), L.latLng(PAR[0], PAR[1]) ],
      lineOptions: {}
    }).addTo(map);

    // NUEVO: leer distancia y tiempo del evento 'routesfound'
    routing.on('routesfound', function (e) {
      // e.routes es un array de alternativas; tomamos la primera (la “mejor”)
      const route = e.routes[0];
      const total = route.summary; // { totalDistance (m), totalTime (s) }

      const dist = formatDistance(total.totalDistance);
      const dura = formatDuration(total.totalTime);

      document.getElementById('stats').innerHTML =
        `Distancia: <strong>${dist}</strong> · Tiempo estimado: <strong>${dura}</strong>`;
    });
  </script>
</body>
</html>